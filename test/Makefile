.SUFFIXES:

CFLAGS=-std=c99 -Wall -Werror -O3

LIBS=check
LDFLAGS=-L../build -lromarth
LDFLAGS+=`pkg-config --cflags --libs $(LIBS)`

LIBRARY=../build/libromarth.a

BUILD_DIR=build

TARGET=$(BUILD_DIR)/test_romarth

SOURCES=check_romarth.c

TESTS=addition_tests.c error_tests.c subtraction_tests.c

OBJECTS=$(addprefix $(BUILD_DIR)/, $(SOURCES:.c=.o))

all: $(BUILD_DIR) $(TARGET)

$(OBJECTS): $(SOURCES) $(TESTS)

$(BUILD_DIR):
	mkdir $@

$(TARGET): $(OBJECTS) $(LIBRARY)
	$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)

$(BUILD_DIR)/%.o: %.c 
	$(CC) $(CFLAGS) -c -o $@ $< 

.PHONY: clean 
.SILENT: clean 

clean:
	rm -rf $(BUILD_DIR)
